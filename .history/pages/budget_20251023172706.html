<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Budget Planner | BizCore360</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body { background-color: #fff; }
    .card { border: none; border-radius: 12px; box-shadow: 0 0 8px rgba(0,0,0,0.05); }

    /* Inner Menu */
    .inner-menu {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
      border-bottom: 1px solid #eaeaea;
      padding-bottom: 0.75rem;
      margin-bottom: 1.5rem;
    }
    .inner-menu a {
      text-decoration: none;
      color: #555;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: color 0.2s ease;
    }
    .inner-menu a.active { color: #0d6efd; }
    .inner-menu a:hover { color: #0d6efd; }
    .inner-menu .separator { color: #ccc; user-select: none; }

    .info-section h6 { color: #0d6efd; font-weight: 600; margin-top: 1rem; }
    .d-none { display: none !important; }
  </style>
</head>

<body>
  <div id="budgetModule" class="container-fluid p-4">
    <div class="card rounded-3 shadow-sm">
      <div class="card-body">
        <h4 id="moduleTitle" class="fw-semibold text-primary mb-3">Budget Planner</h4>

        <!-- INNER MENU -->
        <div class="inner-menu" id="moduleMenu">
          <a href="#" class="active" data-target="main"><i class="bi bi-speedometer2"></i> Overview</a>
          <span class="separator">|</span>
          <a href="#" data-target="info"><i class="bi bi-info-circle"></i> Info</a>
          <span class="separator">|</span>
          <a href="#" data-target="ai"><i class="bi bi-robot"></i> AI Agent</a>
          <span class="separator">|</span>
          <a href="#" data-target="analytics"><i class="bi bi-bar-chart-line"></i> Analytics</a>
          <span class="separator">|</span>
          <a href="#" data-target="best"><i class="bi bi-lightbulb"></i> Best Practices</a>
          <span class="separator">|</span>
          <a href="#" data-target="tech"><i class="bi bi-gear"></i> Tech</a>
        </div>

        <!-- OVERVIEW -->
        <div id="main" class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-semibold text-primary mb-0">Budget Overview</h5>
            <div class="dropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                Compare Versions
              </button>
              <ul class="dropdown-menu" id="versionList"></ul>
            </div>
          </div>
          <div id="moduleData" class="text-muted">
            No active budget yet. Use the AI Agent tab to create one.
          </div>
        </div>

        <!-- INFO -->
        <div id="info" class="content-section d-none">
          <h5 class="fw-semibold mb-3 text-primary">About the Budget Planner</h5>
          <div class="info-section">
            <h6>Purpose</h6>
            <p>The Budget Planner helps you organize your income, expenses, and profit goals. It provides structure and clarity for making financial decisions and forecasting business growth.</p>

            <h6>How It Works</h6>
            <p>It combines manual input fields with AI-assisted suggestions to build and optimize a complete budget. Data syncs with other financial tools like Cash Flow, Forecasts, and Balance Sheet modules for a unified view.</p>

            <h6>Why It Matters</h6>
            <p>Budgeting improves awareness and accountability. It helps prevent financial surprises, allows you to prepare for shortfalls, and ensures your business decisions are guided by accurate numbers.</p>
          </div>
        </div>

        <!-- AI TAB -->
        <div id="ai" class="content-section d-none">
          <h5 class="fw-semibold mb-3 text-primary">AI Agent</h5>
          <div class="border rounded-3 p-3 bg-light" style="min-height:320px;max-height:500px;overflow-y:auto;" id="chatContainer">
            <div id="chatMessages" class="d-flex flex-column gap-3">
              <p class="text-muted small">Start chatting with the AI to create your first budget.</p>
            </div>
          </div>

          <div class="d-flex justify-content-end gap-2 mt-3">
            <button class="btn btn-outline-secondary" id="generateDemo"><i class="bi bi-magic me-1"></i> Generate Sample Budget</button>
            <button class="btn btn-success" id="makeActive"><i class="bi bi-check-circle me-1"></i> Make Active</button>
          </div>

          <div class="d-flex align-items-center mt-3 border rounded-pill px-3 py-2 bg-white shadow-sm position-relative">
            <input type="file" id="fileInput" multiple hidden accept="image/*,.pdf,.doc,.docx,.txt" />
            <button class="btn btn-link text-secondary p-0 me-2" id="chatAdd"><i class="bi bi-plus-circle fs-5"></i></button>
            <input type="text" id="chatInput" class="form-control border-0 flex-grow-1" placeholder="Ask anything..." />
            <button class="btn btn-link text-secondary p-0 ms-2 me-1" id="chatMic"><i class="bi bi-mic fs-5"></i></button>
            <button class="btn btn-light border rounded-circle p-0 d-flex align-items-center justify-content-center shadow-sm me-2"
                    id="chatVoice" style="width:36px;height:36px;" title="Enable Voice Response">
              <i class="bi bi-soundwave fs-5 text-secondary"></i>
            </button>
            <button class="btn btn-primary rounded-circle d-flex align-items-center justify-content-center"
                    id="chatSend" style="width:36px;height:36px;">
              <i class="bi bi-send-fill text-white fs-6"></i>
            </button>
          </div>
        </div>

        <!-- ANALYTICS -->
        <div id="analytics" class="content-section d-none">
          <h5 class="fw-semibold mb-3 text-primary">Analytics</h5>
          <p class="text-muted mb-4">Visualize revenue, expenses, and profit distribution for better financial insights.</p>
          <div class="card border-0 shadow-sm rounded-4">
            <div class="card-body d-flex justify-content-around flex-wrap text-center">
              <div><h6 class="fw-semibold text-primary">Revenue</h6><canvas id="revenueChart" width="200" height="150"></canvas></div>
              <div><h6 class="fw-semibold text-primary">Expenses</h6><canvas id="expensesChart" width="200" height="150"></canvas></div>
              <div><h6 class="fw-semibold text-primary">Profit</h6><canvas id="profitChart" width="200" height="150"></canvas></div>
            </div>
          </div>
        </div>

        <!-- BEST PRACTICES -->
        <div id="best" class="content-section d-none">
          <h5 class="fw-semibold mb-3 text-primary">Budgeting Best Practices</h5>
          <div class="info-section">
            <ul>
              <li>Set clear financial goals and review progress monthly.</li>
              <li>Separate fixed and variable costs for clarity.</li>
              <li>Use conservative revenue projections.</li>
              <li>Track cash flow, not just profit.</li>
              <li>Encourage team collaboration on budgets.</li>
              <li>Leverage the AI Agent for continuous optimization.</li>
            </ul>
          </div>
        </div>

        <!-- TECH -->
        <div id="tech" class="content-section d-none">
          <h5 class="fw-semibold mb-3 text-primary">Technical Overview</h5>
          <div class="info-section">
            <h6>Architecture</h6>
            <p>The Budget module is built with modular HTML components and Bootstrap 5. Each section is dynamically rendered via JavaScript for smooth navigation inside the BizCore360 framework.</p>

            <h6>Core Scripts</h6>
            <ul>
              <li><code>aiHandler.js</code> – Connects to the AI API for text generation and responses.</li>
              <li><code>dataManager.js</code> – Manages CRUD operations for stored versions.</li>
              <li><code>uiHelper.js</code> – Handles DOM updates, modals, and toasts.</li>
            </ul>

            <h6>Data Handling</h6>
            <p>Budget versions are stored in <code>localStorage</code> for quick loading and testing. In production, these connect to the BizCore360 backend API for persistent cloud storage.</p>

            <h6>Analytics Engine</h6>
            <p>Charts are powered by Chart.js. Future integrations will include real-time analytics using the BizCore Data API for financial performance visualization.</p>

            <p class="text-muted small">Repository: <a href="https://github.com/tonym642/bizcore360" target="_blank">github.com/tonym642/bizcore360</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CHART.JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    /* MENU NAVIGATION */
    document.querySelectorAll("#moduleMenu a").forEach(link => {
      link.addEventListener("click", e => {
        e.preventDefault();
        document.querySelectorAll("#moduleMenu a").forEach(a => a.classList.remove("active"));
        link.classList.add("active");
        const t = link.dataset.target;
        document.querySelectorAll(".content-section").forEach(s => s.classList.add("d-none"));
        document.getElementById(t).classList.remove("d-none");
      });
    });

    /* SIMPLE DEMO CHARTS */
    const baseOpts = {
      responsive: false,
      maintainAspectRatio: true,
      plugins: { legend: { display: false } }
    };

    new Chart(document.getElementById("revenueChart"), {
      type: "bar",
      data: { labels: ["Product", "Service", "Other"], datasets: [{ data: [18500, 7200, 800], backgroundColor: ["#0d6efd","#198754","#ffc107"], borderRadius: 6 }] },
      options: baseOpts
    });

    new Chart(document.getElementById("expensesChart"), {
      type: "bar",
      data: { labels: ["Payroll", "Rent", "Marketing"], datasets: [{ data: [9000, 3000, 1200], backgroundColor: ["#dc3545","#fd7e14","#6c757d"], borderRadius: 6 }] },
      options: baseOpts
    });

    new Chart(document.getElementById("profitChart"), {
      type: "bar",
      data: { labels: ["Profit", "Expenses"], datasets: [{ data: [11650, 14850], backgroundColor: ["#198754","#dc3545"], borderRadius: 6 }] },
      options: baseOpts
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
